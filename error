CodeBuild:
    Type: 'AWS::CodeBuild::Project'
    Properties:
      Name: !Sub ${AWS::StackName}-CodeBuild
      ServiceRole: !GetAtt CodeBuildRole.Arn
      Artifacts:
        Type: CODEPIPELINE
        Name: ar-ui-project
      Environment:
        Type: LINUX_CONTAINER
        ComputeType: BUILD_GENERAL1_SMALL
        Image: aws/codebuild/standard:4.0
        EnvironmentVariables:
          - Name: REACT_VERSION
            Value: "^18"
          - Name: NEXT_VERSION
            Value: "14.2.0"
      Source:
        Type: CODEPIPELINE
        BuildSpec: !Sub |
          version: 0.2
          phases:
            install:
              runtime-versions:
                nodejs: 14          
            pre_build:
              commands:
                - echo This will run npm install to install the dependencies...
                - npm install -g npm@7y
                - npm install --legacy-peer-deps
            build:
              commands:
                - echo run the build process
                - npm run build
          artifacts:
            files:
              - '**/*'
            base-directory: build
